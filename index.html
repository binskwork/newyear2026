<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 ì„ ìƒë‹˜ ë•ë‹´ ë“±ë¶ˆ ë„ìš°ê¸° ğŸ®</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body { font-family: "Pretendard", sans-serif; overflow-x: hidden; min-height: 100vh; transition: background 1s ease; }
        .day-theme { background: radial-gradient(circle at top, #fff5f5 0%, #fffaf0 100%); color: #2d3436; }
        .night-theme { background: radial-gradient(circle at top, #1a1a2e 0%, #0f0f1a 100%); color: #f8f9fa; }
        .star { position: fixed; background: white; border-radius: 50%; opacity: 0.6; pointer-events: none; z-index: 1; animation: fall linear infinite; }
        @keyframes fall { from { transform: translateY(-10vh); } to { transform: translateY(110vh); } }
        
        /* ì¹´ë“œ ë””ìì¸ */
        .gold-container { border: 2.5px solid #d4af37; box-shadow: 0 10px 30px rgba(212, 175, 55, 0.15); position: relative; z-index: 20; }
        .card { transition: all 0.3s ease; border-radius: 20px; background: white; color: #333; height: 180px; display: flex; flex-direction: column; justify-content: space-between; position: relative; }
        .honor-card { border: 3px solid #d4af37; background: #fffcf0; box-shadow: 0 0 15px rgba(212, 175, 55, 0.3); }
        .regular-card { border-top: 5px solid #c0392b; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        
        /* ë°°ì§€ ìœ„ì¹˜: ìš°ì¸¡ ìƒë‹¨ ë‹‰ë„¤ì„ ê°€ë¦¼ ë°©ì§€ */
        .top-badge { position: absolute; top: 10px; right: 45px; background: #d4af37; color: white; padding: 2px 8px; border-radius: 10px; font-size: 9px; font-weight: 800; z-index: 30; }

        @keyframes heartBeat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.15); } }
        .like-animation { animation: heartBeat 0.4s ease-in-out; }

        /* ë¶€ì  ëª¨ë‹¬ */
        #charm-modal { display: none; background: rgba(0,0,0,0.9); z-index: 100; align-items: center; justify-content: center; position: fixed; inset: 0; }
        .charm-container { width: 340px; background: white; border-radius: 30px; padding: 20px; text-align: center; }
        #charm-capture { width: 300px; position: relative; margin: 0 auto 20px; border-radius: 15px; overflow: hidden; background-color: #fff; }
        #charm-bg-img { width: 100%; height: auto; display: block; }
        
        /* ì¥ë¬¸ ìš´ì„¸ ìŠ¤íƒ€ì¼ */
        .charm-text { 
            position: absolute; top: 46%; left: 50%; transform: translate(-50%, -50%); 
            width: 80%; text-align: left; color: #4a3318; font-weight: 600; 
            font-size: 0.92rem; line-height: 1.6; word-break: keep-all; pointer-events: none;
            white-space: pre-wrap;
        }

        .card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; padding: 20px; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="day-theme">
    <div id="star-container"></div>

    <header class="text-center pt-8 pb-3 relative z-10">
        <h1 class="text-xl md:text-3xl font-extrabold text-[#c0392b] mb-1 flex justify-center items-center gap-2" id="main-title">
            <span>ğŸ®</span> 2026 ì„ ìƒë‹˜ ë•ë‹´ ë“±ë¶ˆ ë„ìš°ê¸° <span>ğŸ®</span>
        </h1>
        <p class="text-xs md:text-sm text-[#d4af37] font-semibold">ì‹ í•™ê¸°, ì„ ìƒë‹˜ì˜ ì•ë‚ ì„ ë¹„ì¶”ëŠ” ë”°ëœ»í•œ í•œë§ˆë””</p>
        <button onclick="shareLink()" class="mt-3 px-5 py-2 bg-white/80 border border-[#d4af37] text-[#c0392b] rounded-full text-[11px] font-bold shadow-md">ğŸ”— ì´ë²¤íŠ¸ ë§í¬ ë³µì‚¬í•˜ê¸°</button>
    </header>

    <div class="max-w-md mx-auto gold-container bg-white/95 p-6 rounded-[35px] mb-12 mx-4 relative">
        <div class="absolute -top-7 -left-7 text-5xl">ğŸ§§</div>
        <div class="absolute -bottom-7 -right-7 text-5xl">âœ¨</div>
        <div class="flex gap-2 mb-2">
            <input type="text" id="nickname" placeholder="ë‹‰ë„¤ì„" class="w-1/2 p-3 bg-red-50/30 border border-red-100 rounded-xl outline-none text-xs text-gray-800">
            <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸(ì‚­ì œìš©)" class="w-1/2 p-3 bg-red-50/30 border border-red-100 rounded-xl outline-none text-xs text-gray-800">
        </div>
        <textarea id="message" rows="2" placeholder="ìƒˆí•´ì˜ ì†Œë§ì„ ë‹´ì€ ë•ë‹´ì„ ë‚¨ê²¨ì£¼ì„¸ìš”..." class="w-full p-3 bg-red-50/30 border border-red-100 rounded-xl outline-none mb-3 text-sm resize-none text-gray-800"></textarea>
        
        <div class="bg-amber-50/50 p-4 rounded-2xl border border-amber-100 mb-4 text-gray-800">
            <p class="text-[10px] font-bold text-amber-800 mb-2 text-center">ğŸ ì´ë²¤íŠ¸ ë‹¹ì²¨ì ì •ë³´ (ì „ì› í•„ìˆ˜ ì…ë ¥)</p>
            <div class="grid grid-cols-2 gap-2 mb-3">
                <input type="text" id="region" placeholder="ì§€ì—­" class="p-2 border rounded-lg text-[11px] bg-white text-gray-800">
                <input type="text" id="school" placeholder="ì†Œì†êµ" class="p-2 border rounded-lg text-[11px] bg-white text-gray-800">
                <input type="text" id="realName" placeholder="ì‹¤ëª…" class="p-2 border rounded-lg text-[11px] bg-white text-gray-800">
                <input type="text" id="phone" placeholder="ì—°ë½ì²˜" class="p-2 border rounded-lg text-[11px] bg-white text-gray-800">
            </div>
            <div class="text-[9px] text-gray-500 bg-white/50 p-2 rounded-lg border leading-tight mb-3">
                [ê°œì¸ì •ë³´ ìˆ˜ì§‘ ì•ˆë‚´] ìˆ˜ì§‘ì²˜: ì•„ì´ìŠ¤í¬ë¦¼ì•„íŠ¸ / ëª©ì : ê²½í’ˆ ë°œì†¡ / í•­ëª©: ì„±ëª…, ì—°ë½ì²˜, ì§€ì—­, ì†Œì†êµ / ê¸°ê°„: ëª©ì  ë‹¬ì„± í›„ <strong>ì¦‰ì‹œ íŒŒê¸°</strong>
            </div>
            <label class="flex items-center text-[10px] text-gray-600 cursor-pointer font-bold">
                <input type="checkbox" id="agree" class="mr-2 w-4 h-4 accent-[#c0392b]"> ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•©ë‹ˆë‹¤.
            </label>
        </div>
        <button id="submit-btn" class="w-full bg-[#c0392b] text-white py-3.5 rounded-2xl font-bold text-lg shadow-xl active:scale-95 transition-all">ë•ë‹´ ë“±ë¶ˆ ì˜¬ë¦¬ê¸° â¤ï¸</button>
    </div>

    <div class="max-w-6xl mx-auto px-4 mb-10 relative z-10">
        <h2 class="text-[#d4af37] font-bold text-center mb-5 flex items-center justify-center gap-2">
            <span>âœ¨</span> ëª…ì˜ˆì˜ ë•ë‹´ (TOP 10) <span>âœ¨</span>
        </h2>
        <div id="honor-list" class="flex overflow-x-auto gap-5 pb-6 snap-x scrollbar-hide p-2"></div>
    </div>

    <div id="greeting-list" class="card-grid max-w-6xl mx-auto"></div>

    <div id="charm-modal">
        <div class="charm-container shadow-2xl">
            <h3 class="text-xl font-bold text-[#c0392b] mb-4">ë‚˜ì˜ 2026 í–‰ìš´ ë¶€ì </h3>
            <div id="charm-capture">
                <img src="common_base.png" id="charm-bg-img" alt="ë¶€ì  ë°°ê²½">
                <p id="charm-message" class="charm-text"></p>
            </div>
            <div class="flex gap-2">
                <button onclick="downloadCharm()" class="flex-1 bg-[#d4af37] text-white py-4 rounded-2xl font-bold text-sm shadow-md">ì´ˆê³ í™”ì§ˆ ì €ì¥</button>
                <button onclick="closeModal()" class="flex-1 bg-gray-100 text-gray-500 py-4 rounded-2xl font-bold text-sm">ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <div class="text-center py-16 opacity-30 hover:opacity-100 transition-opacity">
        <button onclick="downloadCSV()" class="text-[10px] text-gray-400 underline mr-4">Admin Data Export</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, onSnapshot, query, orderBy, updateDoc, deleteDoc, doc, increment } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyA2cUrJBWa8DnZ10yTbSNkdVvHgNd5XkIc",
            authDomain: "new-year-pj-94d18.firebaseapp.com",
            projectId: "new-year-pj-94d18",
            storageBucket: "new-year-pj-94d18.firebasestorage.app",
            messagingSenderId: "100527886802",
            appId: "1:100527886802:web:ad7c8f1f9298915b90780b",
            measurementId: "G-VZY04YTW61"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const colRef = collection(db, "greetings");

        // ğŸ° ìš´ì„¸ ë°ì´í„° (í¬ê·€ 5, ì¤‘ê°„ 15, ì¼ë°˜ 20)
        const fortunes = {
            rare: [ // 10% - rare_base.png (í¸ì§€ë´‰íˆ¬)
                "ë§Œì‚¬í˜•í†µ(è¬äº‹äº¨é€š)ì˜ ê¸°ìš´!\nì˜¬í•´ëŠ” í–‰ì • ì—…ë¬´ ì œë¡œ, ìˆ˜ì—… ì•„ì´ë””ì–´ ëŒ€ë°•!\nì„ ìƒë‹˜ì´ ê¿ˆê¾¸ë˜ ê°€ì¥ ì´ìƒì ì¸ í•™ê¸‰ ìš´ì˜ì´ í˜„ì‹¤ë¡œ ë‹¤ê°€ì˜µë‹ˆë‹¤. ëª¨ë“  ìˆœê°„ì´ ì„±ì¥ì˜ ë°œíŒì´ ë  ê±°ì˜ˆìš”.",
                "ê³ ì§„ê°ë˜(è‹¦ç›¡ç”˜ä¾†), ì‘ë…„ì˜ ìˆ˜ê³ ê°€ ê½ƒì„ í”¼ì›ë‹ˆë‹¤.\ní˜ë“¤ì—ˆë˜ ê²½í—˜ì€ ë°‘ê±°ë¦„ì´ ë˜ì–´, ì˜¬í•´ëŠ” ì²œì‚¬ ê°™ì€ ì•„ì´ë“¤ê³¼ í™˜ìƒì ì¸ ì¼€ë¯¸ë¥¼ ìë‘í•˜ê²Œ ë©ë‹ˆë‹¤. ì„ ìƒë‹˜ì˜ ì§„ì‹¬ì´ ë“œë””ì–´ ë¹›ì„ ë°œí•©ë‹ˆë‹¤.",
                "ê¸ˆìƒì²¨í™”(éŒ¦ä¸Šæ·»èŠ±), ê¸°ìœ ì†Œì‹ì´ ê²¹ì³ ì˜µë‹ˆë‹¤.\ní•™ê¸‰ ë¶„ìœ„ê¸°ëŠ” ì—­ëŒ€ ìµœê³ , ì—¬ê¸°ì— ìƒê°ì§€ ëª»í•œ í¬ìƒì´ë‚˜ ì˜ˆì‚° ì§€ì›ê¹Œì§€! ì„ ìƒë‹˜ì˜ êµì§ ìƒí™œ ì¤‘ ê°€ì¥ í–‰ë³µí•œ í•œ í•´ê°€ ì•½ì†ë˜ì–´ ìˆìŠµë‹ˆë‹¤.",
                "ì¼ì·¨ì›”ì¥(æ—¥å°±æœˆå°‡), ì „ë¬¸ì„±ì´ í­ë°œí•˜ëŠ” í•´!\nìƒˆë¡œìš´ ì—°ìˆ˜ë‚˜ ì—°êµ¬ í™œë™ì—ì„œ ìµœê³ ì˜ ì„±ê³¼ë¥¼ ê±°ë‘ë©°, ë™ë£Œë“¤ì—ê²Œ ê·€ê°ì´ ë˜ëŠ” 'ê°“ì„ ìƒë‹˜'ìœ¼ë¡œ ê±°ë“­ë‚©ë‹ˆë‹¤. ì„ ìƒë‹˜ì˜ ê°€ì¹˜ê°€ ì¦ëª…ë˜ëŠ” í•´ê°€ ë  ê±°ì˜ˆìš”.",
                "ì „ë„ìœ ë§(å‰é€”æœ‰æœ›), ë°ì€ ë¯¸ë˜ê°€ ì—´ë¦½ë‹ˆë‹¤.\nì‹ í•™ê¸° ë°°ì •ë¶€í„° í•™ê¸‰ êµ¬ì„±ê¹Œì§€, ëª¨ë“  ìš´ì´ ì„ ìƒë‹˜ í¸ì…ë‹ˆë‹¤. ì–´ë–¤ ë„ì „ë„ ì„±ê³µìœ¼ë¡œ ì´ì–´ì§€ë©°, ì¼ ë…„ ë‚´ë‚´ ì›ƒìŒ ëŠì´ì§€ ì•ŠëŠ” êµì‹¤ì´ ë©ë‹ˆë‹¤."
            ],
            medium: [ // 25% - medium_base.png (ê½ƒë¬´ëŠ¬)
                "ì˜¬í•´ëŠ” 'ì¹¼í‡´ ìš”ì •'ì´ ì„ ìƒë‹˜ ê³ì„ ì§€í‚µë‹ˆë‹¤.\nê³µë¬¸ ì²˜ë¦¬ê°€ ë¹›ì˜ ì†ë„ë¡œ í•´ê²°ë˜ê³ , ë§¤ì¼ ì €ë… ì˜¨ì „í•œ íœ´ì‹ ì‹œê°„ì´ ë³´ì¥ë˜ëŠ” ê¸°ì  ê°™ì€ ì—…ë¬´ìš´ì´ ë”°ë¦…ë‹ˆë‹¤.",
                "ë™ë£Œ ì„ ìƒë‹˜ë“¤ê³¼ì˜ ì°°ë–¡ê¶í•© íŒ€ì›Œí¬!\në§ˆìŒ ë§ëŠ” ì˜† ë°˜ ì„ ìƒë‹˜ ë•ë¶„ì— í˜ë“  ì¼ë„ ì›ƒìœ¼ë©° ë„˜ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë“ ë“ í•œ ë™ë£Œì•  ì†ì—ì„œ êµì§ì˜ ì¦ê±°ì›€ì„ ë‹¤ì‹œ ë°œê²¬í•©ë‹ˆë‹¤.",
                "í•™ë¶€ëª¨ë‹˜ë“¤ì˜ ê¹Šì€ ì‹ ë¢°ì™€ ì§€ì§€.\nì„ ìƒë‹˜ì˜ êµìœ¡ ì² í•™ì„ ì§€ì§€í•´ì£¼ëŠ” ë“ ë“ í•œ í•™ë¶€ëª¨ë‹˜ë“¤ ë•ë¶„ì—, ìƒë‹´ ì‹œê°„ì´ ê¸°ë‹¤ë ¤ì§€ëŠ” ë§ˆë²• ê°™ì€ ì†Œí†µì˜ ìš´ì´ ë“¤ì–´ì™€ ìˆìŠµë‹ˆë‹¤.",
                "ì•„ì´ë“¤ì˜ ëˆˆë¹›ì´ ì´ˆë¡±ì´ˆë¡±í•˜ê²Œ ë¹›ë‚˜ëŠ” í•´.\nì„¤ëª… í•œë§ˆë””ì— ì§‘ì¤‘í•˜ëŠ” ì•„ì´ë“¤ì˜ ëª¨ìŠµì—ì„œ ê¹Šì€ ë³´ëŒì„ ëŠë‚ë‹ˆë‹¤. ìˆ˜ì—…ì˜ ì¬ë¯¸ì™€ êµì‚¬ì˜ ê¸ì§€ë¥¼ ë™ì‹œì— ì±™ê¸°ê²Œ ë  ê±°ì˜ˆìš”.",
                "ì°½ì˜ì  ì²´í—˜í™œë™ ì•„ì´ë””ì–´ ë±…í¬ ë“±ê·¹!\nìˆ˜ì—… ì‹œê°„ë§ˆë‹¤ í†¡í†¡ íŠ€ëŠ” í™œë™ìœ¼ë¡œ ì•„ì´ë“¤ì„ ì‚¬ë¡œì¡ìŠµë‹ˆë‹¤. ì„ ìƒë‹˜ì˜ ìˆ˜ì—… ë°©ì‹ì€ í•™êµì˜ ìƒˆë¡œìš´ íŠ¸ë Œë“œê°€ ë©ë‹ˆë‹¤.",
                "í•™ê¸‰ ë¹„í’ˆê³¼ ì˜ˆì‚°ì´ ë„‰ë„‰íˆ í™•ë³´ë©ë‹ˆë‹¤.\nì›í•˜ë˜ êµêµ¬ë“¤ì´ ì²™ì²™ ì¤€ë¹„ë˜ì–´, ì„ ìƒë‹˜ì´ ê¿ˆê¾¸ë˜ ì˜ˆìœ êµì‹¤ ê³µê°„ì„ ì™„ë²½í•˜ê²Œ ê¾¸ë¯¸ê²Œ ë˜ëŠ” í’ìš”ë¡œìš´ í•´ì…ë‹ˆë‹¤.",
                "ì˜ˆê¸°ì¹˜ ëª»í•œ ë³´ë„ˆìŠ¤ë‚˜ ì„±ê³¼ê¸‰ì˜ í–‰ìš´!\nì„±ì‹¤íˆ ê±¸ì–´ì˜¨ ê¸¸ì— ëŒ€í•œ ë³´ìƒì´ ì°¾ì•„ì˜µë‹ˆë‹¤. ê¸ˆì „ì ì¸ ì—¬ìœ ì™€ í•¨ê»˜ ë§ˆìŒê¹Œì§€ ë„‰ë„‰í•´ì§€ëŠ” ê¸°ë¶„ ì¢‹ì€ ì†Œì‹ì´ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.",
                "ê³µê°œ ìˆ˜ì—…ì´ 'ì¸ìƒ ìˆ˜ì—…'ì´ ë˜ëŠ” ë‚ .\në–¨ë¦¼ì€ ì„¤ë ˜ìœ¼ë¡œ ë°”ë€Œê³ , ì°¸ê´€í•˜ì‹œëŠ” ë¶„ë“¤ì˜ ê·¹ì°¬ ì†ì— ë§ˆë¬´ë¦¬ë©ë‹ˆë‹¤. ì„ ìƒë‹˜ì˜ ì—­ëŸ‰ì´ ìë‘ìŠ¤ëŸ½ê²Œ ë¹›ë‚˜ëŠ” ìˆœê°„ì´ ì˜µë‹ˆë‹¤.",
                "ì§€ì¹œ ì¼ìƒ ì† ì†Œì†Œí•˜ì§€ë§Œ í™•ì‹¤í•œ í–‰ë³µ.\nê¸‰ì‹ ë©”ë‰´ê°€ ë§¤ì¼ ìµœì•  ë°˜ì°¬ìœ¼ë¡œ ë‚˜ì˜¤ê³ , ì£¼ì°¨ ìë¦¬ê°€ ëŠ˜ ëª…ë‹¹ì¸ ì†Œì†Œí•œ í–‰ìš´ë“¤ì´ ì„ ìƒë‹˜ì˜ ì¼ìƒì„ ì¦ê²ê²Œ ì±„ì›Œì¤„ ê²ƒì…ë‹ˆë‹¤.",
                "í•™ê¸° ë§ ìƒí™œê¸°ë¡ë¶€ ì‘ì„±ì´ ìˆ˜ì›”í•´ì§‘ë‹ˆë‹¤.\nì•„ì´ë“¤ì˜ ì¥ì ì´ ëˆˆì— ì™ì™ ë“¤ì–´ì™€ ë¬¸ì¥ì´ ìˆ ìˆ  ì¨ì§€ëŠ” ë§ˆë²•! ë°¤ìƒ˜ ì—†ëŠ” í‰ì˜¨í•œ ë§ˆë¬´ë¦¬ê°€ ì„ ìƒë‹˜ì„ ê¸°ë‹¤ë¦¬ê³  ìˆìŠµë‹ˆë‹¤.",
                "ì‹ í•™ê¸° ì²«ë‚ , ì•„ì´ë“¤ê³¼ì˜ ê¸°ë¶„ ì¢‹ì€ ë§Œë‚¨.\nì„ ìƒë‹˜ì„ ê¸°ë‹¤ë ¤ì˜¨ ì•„ì´ë“¤ì˜ ì„¤ë ˆëŠ” í‘œì •ì—ì„œ ì—ë„ˆì§€ë¥¼ ì–»ìŠµë‹ˆë‹¤. ì²« ë‹¨ì¶”ë¶€í„° ì™„ë²½í•˜ê²Œ ë¼ì›Œì§€ëŠ” ì‹ í•™ê¸° ìš´ì…ë‹ˆë‹¤.",
                "êµì‚¬ ë™ì•„ë¦¬ë‚˜ ì·¨ë¯¸ í™œë™ì—ì„œì˜ í° ì¦ê±°ì›€.\ní•™êµ ë°– ì‚¶ì—ì„œë„ í™œë ¥ì„ ì°¾ê²Œ ë©ë‹ˆë‹¤. ì›Œë¼ë°¸ì´ ì™„ë²½í•˜ê²Œ ê· í˜•ì„ ì´ë£¨ë©° ì‚¶ì˜ ì§ˆì´ í•œ ë‹¨ê³„ ì—…ê·¸ë ˆì´ë“œë©ë‹ˆë‹¤.",
                "ë‚˜ë¥¼ í˜ë“¤ê²Œ í•˜ë˜ ê³ ì§ˆì ì¸ ë¬¸ì œê°€ í•´ê²°ë©ë‹ˆë‹¤.\nê¹Œë‹¤ë¡œì› ë˜ ì—…ë¬´ë‚˜ ê´€ê³„ì˜ ì‹¤íƒ€ë˜ê°€ ìˆ ìˆ  í’€ë ¤, ë§ˆìŒì˜ ì§ì„ ë‚´ë ¤ë†“ê³  í™€ê°€ë¶„í•˜ê²Œ ì§€ë‚¼ ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.",
                "ì„ ìƒë‹˜ì˜ ê±´ê°•ì´ ìµœê³ ì¡°ì— ë‹¬í•˜ëŠ” í•´.\nì¼ ë…„ ë‚´ë‚´ ì”ë³‘ì¹˜ë ˆ ì—†ì´ ì—ë„ˆì§€ê°€ ë„˜ì¹©ë‹ˆë‹¤. ê·œì¹™ì ì¸ ìƒí™œê³¼ ê¸ì •ì ì¸ ë§ˆìŒê°€ì§ì´ ì„ ìƒë‹˜ì„ í™œê¸°ì°¨ê²Œ ë§Œë“­ë‹ˆë‹¤.",
                "ì•„ì´ë“¤ì˜ ì¼ê¸° ì†ì— ë‹´ê¸´ ì„ ìƒë‹˜ í–¥í•œ ì§„ì‹¬.\n\"ì„ ìƒë‹˜ì´ ìš°ë¦¬ ë‹´ì„ì´ë¼ì„œ ì •ë§ ì¢‹ì•„ìš”\"ë¼ëŠ” ë¬¸êµ¬ í•œ ì¤„ì— ëª¨ë“  í”¼ë¡œê°€ ë…¹ì•„ë‚´ë¦¬ëŠ” ê°ë™ì ì¸ ìˆœê°„ì´ ì°¾ì•„ì˜¬ ê²ƒì…ë‹ˆë‹¤."
            ],
            common: [ // 65% - common_base.png (ë§/ì¥ì‹)
                "ì•ˆì „í•˜ê³  í‰ì˜¨í•œ êµì‹¤ ìš´ì˜ì´ ë³´ì¥ë©ë‹ˆë‹¤.\nì‚¬ê³  ì—†ëŠ” 365ì¼, ì•„ì´ë“¤ì´ ê±´ê°•í•˜ê²Œ ìƒí™œí•˜ë©° ì„ ìƒë‹˜ì˜ ë§ˆìŒë„ í‰í™”ë¡œìš´ ë¬´ì‚¬íƒœí‰í•œ í•œ í•´ê°€ ì•½ì†ë˜ì–´ ìˆìŠµë‹ˆë‹¤.",
                "ë”°ëœ»í•œ ì»¤í”¼ í•œ ì”ì˜ ì—¬ìœ ê°€ ìˆëŠ” ì•„ì¹¨.\nì¶œê·¼ í›„ ìˆ˜ì—… ì‹œì‘ ì „, ì˜¨ì „íˆ ë‚˜ë¥¼ ìœ„í•œ ì§§ì€ íœ´ì‹ì´ ë³´ì¥ë©ë‹ˆë‹¤. ê·¸ ì—¬ìœ ê°€ ì„ ìƒë‹˜ì˜ í•˜ë£¨ë¥¼ ì˜¨ì¢…ì¼ ì§€íƒ±í•´ ì¤„ ê±°ì˜ˆìš”.",
                "ì•„ì´ë“¤ì˜ ìˆœìˆ˜í•œ ë¯¸ì†Œì—ì„œ ì–»ëŠ” íë§.\në³µë„ì—ì„œ ë§ˆì£¼ì¹  ë•Œë§ˆë‹¤ ë°ê²Œ ì›ƒìœ¼ë©° ì¸ì‚¬í•˜ëŠ” ì•„ì´ë“¤ ë•ë¶„ì—, ì„ ìƒë‹˜ì˜ ì…ê°€ì—ë„ ëŠ˜ ë¯¸ì†Œê°€ ë– ë‚˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤.",
                "ì˜¤ëŠ˜ í•˜ë£¨ë„ ë¬´ì‚¬íˆ ë§ˆì¹œ ë‹¹ì‹ ì—ê²Œ ë°•ìˆ˜ë¥¼.\ní° ì´ë²¤íŠ¸ëŠ” ì—†ì–´ë„ ë³„ íƒˆ ì—†ì´ ì§€ë‚˜ê°€ëŠ” í‰ë²”í•œ í•˜ë£¨ê°€ ìŒ“ì—¬ ì„ ìƒë‹˜ì˜ ê°€ì¥ ë‹¨ë‹¨í•œ êµì§ ê²½ë ¥ì´ ë©ë‹ˆë‹¤.",
                "í‡´ê·¼ê¸¸ ë§ˆì£¼í•˜ëŠ” ìœ ë‚œíˆ ì˜ˆìœ ë…¸ì„.\në°”ìœ ì—…ë¬´ë¥¼ ë§ˆì¹˜ê³  ë‚˜ì„œëŠ” ê¸¸, í•˜ëŠ˜ì´ ì£¼ëŠ” ì‘ì€ ì„ ë¬¼ì— ìœ„ë¡œë°›ëŠ” í•˜ë£¨ê°€ ë§ì•„ì§‘ë‹ˆë‹¤. ìì—°ì´ ì£¼ëŠ” íë§ì„ ëˆ„ë¦¬ì„¸ìš”.",
                "ì•„ì´ë“¤ì´ ìŠ¤ìŠ¤ë¡œ ì •ë¦¬ì •ëˆí•˜ëŠ” ê¸°íŠ¹í•œ ë‚ .\nì”ì†Œë¦¬ ì—†ì´ë„ êµì‹¤ì´ ê¹¨ë—í•˜ê²Œ ìœ ì§€ë˜ëŠ” ì†Œì†Œí•œ ê¸°ì¨! ì„ ìƒë‹˜ì˜ ì§€ë„ ë°©ì‹ì´ ì•„ì´ë“¤ì˜ ìŠµê´€ìœ¼ë¡œ ìë¦¬ ì¡ëŠ” ìˆœê°„ì…ë‹ˆë‹¤.",
                "ë¹„ ì˜¤ëŠ” ë‚  ì°½ê°€ì—ì„œ ì•„ì´ë“¤ê³¼ ì½ëŠ” ë™í™”ì±….\nì°¨ë¶„í•œ ë¶„ìœ„ê¸° ì†ì—ì„œ ì•„ì´ë“¤ê³¼ ê³µê°ëŒ€ë¥¼ í˜•ì„±í•˜ëŠ” ë‚­ë§Œì ì¸ ì‹œê°„ë“¤ì´ ì„ ìƒë‹˜ì˜ ì •ì„œë¥¼ ì±„ì›Œì¤„ ê²ƒì…ë‹ˆë‹¤.",
                "ë³µì‚¬ê¸°ê°€ ê³ ì¥ ì—†ì´ ì²™ì²™ ì‘ë™í•˜ëŠ” í–‰ìš´.\në°”ìœ ì•„ì¹¨, ì„ ìƒë‹˜ì˜ ìˆ˜ê³ ë¥¼ ëœì–´ì£¼ëŠ” ì†Œì†Œí•œ ê¸°ê³„ìš´ê¹Œì§€ ë”°ë¥´ëŠ” ë‚ ë“¤! í¸ì•ˆí•œ ê·¼ë¬´ í™˜ê²½ì´ ì¡°ì„±ë©ë‹ˆë‹¤.",
                "ë‚´ ì±…ìƒ ìœ„ì— ëª°ë˜ ë†“ì¸ ì•„ì´ì˜ ì‚¬íƒ• í•œ ì•Œ.\nì„œíˆ° ê¸€ì”¨ë¡œ ì“´ 'ì‚¬ë‘í•´ìš”' ìª½ì§€ì™€ ì „ë‹¬ëœ ì§„ì‹¬ì´ ì„ ìƒë‹˜ì˜ êµì‚¬ë¡œì„œì˜ ì¡´ì¬ ì´ìœ ë¥¼ ë‹¤ì‹œê¸ˆ ì¼ê¹¨ì›Œ ì¤ë‹ˆë‹¤.",
                "ì ì‹¬ ê¸‰ì‹ ë©”ë‰´ê°€ ìœ ë‚œíˆ ë§›ìˆëŠ” í•˜ë£¨.\nì¢‹ì•„í•˜ëŠ” ë©”ë‰´ê°€ ê°€ë“í•œ ì‹íŒì„ ë§ˆì£¼í•˜ë©° ë™ë£Œë“¤ê³¼ ì¦ê±°ìš´ ëŒ€í™”ë¥¼ ë‚˜ëˆ„ëŠ” ì‹œê°„. ì†Œë°•í•œ í–‰ë³µì´ ë§¤ì¼ ì´ì–´ì§‘ë‹ˆë‹¤.",
                "í•™ê¸‰ ë¹„í’ˆì´ ë¶„ì‹¤ ì—†ì´ ì˜ ë³´ì¡´ë˜ëŠ” í•´.\në¬¼ê±´ í•˜ë‚˜í•˜ë‚˜ë¥¼ ì•„ê»´ ì“°ëŠ” ì•„ì´ë“¤ì˜ ëª¨ìŠµì—ì„œ êµìœ¡ì˜ ê²°ì‹¤ì„ ë´…ë‹ˆë‹¤. ìŠ¤íŠ¸ë ˆìŠ¤ ì—†ëŠ” ë¹„í’ˆ ê´€ë¦¬ê°€ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.",
                "ìˆ˜ì—… ì¢…ì´ ì¹˜ê¸° ì „ ì™„ë²½í•˜ê²Œ ëë‚˜ëŠ” íŒì„œ.\nì‹œê°„ ë°°ë¶„ì´ ì²™ì²™ ë§ì•„ë–¨ì–´ì§€ëŠ” ì™„ë²½í•œ ê°•ì˜ìš´! ì„ ìƒë‹˜ì˜ ìˆ˜ì—… ë¦¬ë“¬ì´ ì•„ì´ë“¤ì˜ ë°°ì›€ê³¼ ì¡°í™”ë¥¼ ì´ë£¹ë‹ˆë‹¤.",
                "ë‹¨í†¡ë°© ì•Œë¦¼ì´ ì¡°ìš©í•œ í‰í™”ë¡œìš´ ì €ë….\ní‡´ê·¼ í›„ì—ëŠ” ì˜¨ì „íˆ ì„ ìƒë‹˜ë§Œì˜ ì‹œê°„ì…ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ì—°ë½ ì—†ì´ íœ´ì‹ì—ë§Œ ì§‘ì¤‘í•  ìˆ˜ ìˆëŠ” í‡´ê·¼ í›„ì˜ í‰í™”ê°€ ì§€ì¼œì§‘ë‹ˆë‹¤.",
                "ê³„íší–ˆë˜ ì§„ë„ê°€ ì°¨ì§ˆ ì—†ì´ ì§„í–‰ë©ë‹ˆë‹¤.\nì˜ˆìƒì¹˜ ëª»í•œ í–‰ì‚¬ë¡œ ìˆ˜ì—…ì´ ë¹ ì§€ëŠ” ì¼ ì—†ì´, ì°¨ê·¼ì°¨ê·¼ êµìœ¡ê³¼ì •ì„ ì™„ìˆ˜í•˜ë©° ëŠë¼ëŠ” ì„±ì·¨ê°ì´ ìì‹ ê°ì„ ë†’ì—¬ì¤ë‹ˆë‹¤.",
                "ì•„ì´ë“¤ì´ ì„œë¡œ ë°°ë ¤í•˜ë©° ë‹¤íˆ¼ ì—†ëŠ” êµì‹¤.\nì¤‘ì¬í•  ì¼ ì—†ì´ ì•„ì´ë“¤ë¼ë¦¬ í•´ê²°í•˜ëŠ” ì„±ìˆ™í•œ ëª¨ìŠµ. ì„ ìƒë‹˜ì˜ ì¸ì„± êµìœ¡ì´ ì•„ì´ë“¤ì˜ ì‚¶ì— ë…¹ì•„ë“¤ì–´ í‰í™”ë¡œìš´ ê³µë™ì²´ë¥¼ ë§Œë“­ë‹ˆë‹¤.",
                "ì˜¤ëŠ˜ë”°ë¼ ì‹ í˜¸ë“±ì´ ì—°ì† ì´ˆë¡ë¶ˆì¸ ì¶œê·¼ê¸¸.\ní•˜ë£¨ì˜ ì‹œì‘ë¶€í„° ìš´ì´ ë”°ë¥´ëŠ” ê¸°ë¶„ ì¢‹ì€ ì§•ì¡°ë“¤. ì´ëŸ° ì‘ì€ í–‰ìš´ë“¤ì´ ëª¨ì—¬ ì„ ìƒë‹˜ì˜ 2026ë…„ì€ ê±°ëŒ€í•œ í–‰ë³µì´ ë  ê²ƒì…ë‹ˆë‹¤.",
                "ì„ ìƒë‹˜ì˜ ëª© ìƒíƒœê°€ ì¼ ë…„ ë‚´ë‚´ ìŒ©ìŒ©í•©ë‹ˆë‹¤.\në¬´ë¦¬ê°€ ê°ˆ ë²•í•œ ë‚ ì—ë„ ëª©ì†Œë¦¬ê°€ ì˜ ë‚˜ì™€ ìˆ˜ì—…ì´ ì¦ê±°ì›Œì§‘ë‹ˆë‹¤. ì„ ìƒë‹˜ì˜ ëª©ì†Œë¦¬ê°€ ì•„ì´ë“¤ì—ê²Œ ê°€ì¥ ì•„ë¦„ë‹¤ìš´ ìŒì•…ì´ ë©ë‹ˆë‹¤.",
                "ìƒê¸°ë¶€ ì˜¤íƒ€ë¥¼ ì œì¶œ ì§ì „ì— ë°œê²¬í•˜ëŠ” ì²œìš´.\ní° ì‹¤ìˆ˜ë¥¼ ë§‰ì•„ì£¼ëŠ” ì˜ˆë¦¬í•œ ê´€ì°°ë ¥ê³¼ ìš´ì´ í•¨ê»˜í•©ë‹ˆë‹¤. ì™„ë²½í•œ ë§ˆë¬´ë¦¬ë¡œ ì‹ ë¢°ë°›ëŠ” êµì‚¬ì˜ í’ˆê²©ì„ ìœ ì§€í•˜ê²Œ ë  ê²ƒì…ë‹ˆë‹¤.",
                "ì•„ì´ë“¤ì˜ ì›ƒìŒì†Œë¦¬ê°€ ìŒì•…ì²˜ëŸ¼ ë“¤ë¦¬ëŠ” ì˜¤í›„.\nêµì‹¤ ê°€ë“ í¼ì§€ëŠ” ê±´ê°•í•œ ì›ƒìŒì†Œë¦¬ê°€ ì§€ì¹œ ë§ˆìŒì„ ì–´ë£¨ë§Œì ¸ ì¤ë‹ˆë‹¤. ì•„ì´ë“¤ì˜ í–‰ë³µì´ ê³§ ì„ ìƒë‹˜ì˜ í–‰ë³µì´ ë˜ëŠ” í•´ì…ë‹ˆë‹¤.",
                "ì˜¤ëŠ˜ í•˜ë£¨ë„ ë‹¹ì‹ ì˜ ìë¦¬ì—ì„œ ìµœì„ ì„ ë‹¤í–ˆìŠµë‹ˆë‹¤.\nëˆˆì— ë„ëŠ” ì„±ê³¼ê°€ ì—†ì–´ë„ ë‹¹ì‹ ì€ ì´ë¯¸ ì¶©ë¶„íˆ í›Œë¥­í•œ êµì‚¬ì…ë‹ˆë‹¤. ìŠ¤ìŠ¤ë¡œë¥¼ í† ë‹¥ì—¬ì£¼ì„¸ìš”. ë‹¹ì‹ ì€ ì•„ì´ë“¤ì˜ ì˜ì›…ì…ë‹ˆë‹¤."
            ]
        };

        // ğŸ› ï¸ ì €ì¥ í•¨ìˆ˜ ë° ìœ íš¨ì„± ê²€ì‚¬ (ì½”ë“œ ì¤‘ë‹¨ ë°©ì§€ë¥¼ ìœ„í•´ ì™¸ë¶€ì— ì •ì˜)
        window.saveGreeting = async () => {
            if(localStorage.getItem('registered_2026')) return alert("ì´ë¯¸ ì†Œì¤‘í•œ ë•ë‹´ì„ ë‚¨ê²¨ì£¼ì…¨ìŠµë‹ˆë‹¤! ğŸ˜Š");

            const getVal = (id) => {
                const el = document.getElementById(id);
                return el ? el.value.trim() : "";
            };

            const data = {
                nickname: getVal('nickname'), password: getVal('password'), message: getVal('message'),
                region: getVal('region'), school: getVal('school'), realName: getVal('realName'), phone: getVal('phone')
            };
            const agree = document.getElementById('agree') ? document.getElementById('agree').checked : false;

            // âš ï¸ íŒì—… ê²€ì‚¬ ë¡œì§ (ë¹ˆì¹¸ ìˆìœ¼ë©´ ì¦‰ì‹œ ì¤‘ë‹¨)
            if(!data.nickname || !data.password || !data.message || !data.region || !data.school || !data.realName || !data.phone) {
                return alert("âš ï¸ ì´ë²¤íŠ¸ ì°¸ì—¬ë¥¼ ìœ„í•´ ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”! ë¹ˆì¹¸ì´ ìˆìœ¼ë©´ ë“±ë¶ˆì„ ë„ìš¸ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            }
            if(!agree) return alert("âš ï¸ ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ì•ˆë‚´ì— ë™ì˜í•´ ì£¼ì„¸ìš”!");

            try {
                const docRef = await addDoc(colRef, { ...data, likes: 0, createdAt: new Date() });
                localStorage.setItem('registered_2026', 'true');

                // í™•ë¥  ê¸°ë°˜ ìš´ì„¸ ê²°ì • (í¬ê·€:í¸ì§€ë´‰íˆ¬, ì¤‘ê°„:ê½ƒë¬´ëŠ¬, ì¼ë°˜:ë§/ì¥ì‹)
                const random = Math.random();
                let selected, img;
                if (random < 0.1) { selected = fortunes.rare; img = 'rare_base.png'; }
                else if (random < 0.35) { selected = fortunes.medium; img = 'medium_base.png'; }
                else { selected = fortunes.common; img = 'common_base.png'; }
                
                document.getElementById('charm-message').innerText = selected[Math.floor(Math.random() * selected.length)];
                document.getElementById('charm-bg-img').src = img;
                document.getElementById('charm-modal').style.display = 'flex';
            } catch (e) { alert("ì—°ê²° ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”."); }
        };

        // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ë°”ì¸ë”© (DOM ë¡œë“œ í›„)
        document.getElementById('submit-btn').addEventListener('click', window.saveGreeting);

        // ì‹¤ì‹œê°„ ë°ì´í„° ë¡œë“œ
        onSnapshot(query(colRef, orderBy("likes", "desc"), orderBy("createdAt", "desc")), (snapshot) => {
            const hList = document.getElementById('honor-list');
            const gList = document.getElementById('greeting-list');
            hList.innerHTML = ''; gList.innerHTML = '';
            let count = 0;
            snapshot.forEach((docSnap) => {
                const item = docSnap.data();
                const id = docSnap.id;
                const cardHtml = `
                    <div id="card-${id}" class="card ${count < 10 ? 'honor-card snap-center min-w-[260px]' : 'regular-card'} p-5 shadow-lg">
                        ${count < 10 ? `<span class="top-badge">TOP ${count+1}</span>` : ''}
                        <button onclick="window.deletePost('${id}', '${item.password}')" class="absolute top-3 right-4 text-gray-300 hover:text-red-500 font-bold z-30">âœ•</button>
                        <div>
                            <p class="text-[10px] text-[#c0392b] font-bold mb-1">@${item.nickname}</p>
                            <p class="text-gray-800 text-[14px] leading-relaxed font-medium line-clamp-3">${item.message}</p>
                        </div>
                        <div class="flex justify-between items-center border-t pt-3 mt-2">
                            <button onclick="window.likePost('${id}')" class="text-red-500 font-bold text-xs hover:scale-110 transition-transform">â¤ï¸ <span>${item.likes}</span></button>
                            <span class="text-[9px] text-gray-400 font-light">${new Date(item.createdAt.seconds * 1000).toLocaleDateString()}</span>
                        </div>
                    </div>`;
                if(count < 10) hList.innerHTML += cardHtml; else gList.innerHTML += cardHtml;
                count++;
            });
        });

        window.likePost = async (id) => {
            if(localStorage.getItem('voted_2026_'+id)) return alert("ì´ë¯¸ ì‘ì›í•´ì£¼ì‹  ë•ë‹´ì…ë‹ˆë‹¤! â¤ï¸");
            const card = document.getElementById('card-' + id);
            card.classList.add('like-animation');
            await updateDoc(doc(db, "greetings", id), { likes: increment(1) });
            localStorage.setItem('voted_2026_'+id, true);
            setTimeout(() => card.classList.remove('like-animation'), 500);
        };

        window.deletePost = async (id, correctPw) => {
            const pw = prompt("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
            if (pw === String(correctPw) || pw === "admin2026") {
                if (confirm("ì •ë§ë¡œ ì´ ë“±ë¶ˆì„ ë„ì‹œê² ìŠµë‹ˆê¹Œ? ì‚­ì œ í›„ ë‹¤ì‹œ ì°¸ì—¬ ê°€ëŠ¥í•©ë‹ˆë‹¤.")) {
                    await deleteDoc(doc(db, "greetings", id));
                    localStorage.removeItem('registered_2026');
                    alert("ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë“±ë¡í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸ˜Š");
                    location.reload();
                }
            } else if (pw !== null) alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        };

        window.downloadCharm = () => {
            const target = document.querySelector("#charm-capture");
            html2canvas(target, { scale: 4, useCORS: true, backgroundColor: null }).then(canvas => {
                const link = document.createElement('a');
                link.download = `2026_í–‰ìš´ë¶€ì _${Date.now()}.png`;
                link.href = canvas.toDataURL('image/png', 1.0);
                link.click();
            });
        };

        window.closeModal = () => { location.reload(); };

        // ë³„ ìƒì„± ë° í…Œë§ˆ
        const container = document.getElementById('star-container');
        for (let i = 0; i < 40; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            star.style.width = Math.random() * 2 + 1 + 'px'; star.style.height = star.style.width;
            star.style.left = Math.random() * 100 + 'vw'; star.style.top = Math.random() * -100 + 'vh';
            star.style.animationDuration = Math.random() * 10 + 5 + 's';
            container.appendChild(star);
        }
        if (new Date().getHours() >= 18 || new Date().getHours() < 6) {
            document.body.classList.replace('day-theme', 'night-theme');
            document.getElementById('main-title').classList.replace('text-[#c0392b]', 'text-[#ffcc00]');
        }

        window.shareLink = () => {
            navigator.clipboard.writeText(window.location.href).then(() => alert("ì´ë²¤íŠ¸ ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! â¤ï¸"));
        };

        window.downloadCSV = async () => {
            const pw = prompt("Admin?"); if (pw !== "admin2026") return;
            const snap = await getDocs(colRef);
            let csv = "\uFEFFë‹‰ë„¤ì„,ë©”ì„¸ì§€,ì§€ì—­,í•™êµ,ì‹¤ëª…,ì—°ë½ì²˜,ì¢‹ì•„ìš”,ë‚ ì§œ\n";
            snap.forEach(d => {
                const v = d.data();
                csv += `"${v.nickname}","${v.message}","${v.region}","${v.school}","${v.realName}","${v.phone}",${v.likes},"${new Date(v.createdAt.seconds*1000).toLocaleString()}"\n`;
            });
            const blob = new Blob([csv], {type: "text/csv;charset=utf-8;"});
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = "event_data.csv";
            link.click();
        };
    </script>
</body>
</html>
